list.files()
sheets <-   excel_sheets(list.files()[i])
sheets
l_sheets <- tolower(sheets)
l_sheets
sheets <-   tolower(excel_sheets(list.files()[i]))
sheets
"varlist" %in% sheets
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
sheets
"varlist" %in% sheets
?excel_sheets
ds <- read_excel(workFile,"varlist")
View(ds)
typeof(ds)
ds[[1]]
ds[[2]]
nammes(ds)
names(ds)
ds[1,2]
ds[[1,2]]
ds[[1,]]
ds[[1,3]]
ds[[1,]]
ds[[1,1]]
ds[[1,1:ncol(ds)]]
ncol(ds)
ds[[1,1:7]]
ds[1,1;7]
ds[1,1:7]
?as.data.frame
factors(ds)
?factor
?is.factor
is.factor(ds[[1]])
df <- as.data.frame(ds)
View(df)
df[1,3]
df[[1,]]
df[1,]
df[6,]
df[[1]]
df[1]
df[4]
df[2]
typeof(df)
typeof(ds)
colnames(ds)
names(ds)
gsub(".*\\.","", colnames(ds))
?prompt
ds_list <- list()
i <- 1
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
("varlist" %in% sheets)
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
ds <- read_excel(workFile,sheetName)
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
for (i in 1:length(list.files()) {
i
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
("varlist" %in% sheets)
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
if ("varlist" %in% sheets) {
ds <- read_excel(workFile,"varlist")
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
ds <- read_excel(workFile,sheetName)
}
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
?rm
rm(ds)
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
if ("varlist" %in% sheets) {
ds <- read_excel(workFile,"varlist")
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
ds <- read_excel(workFile,sheetName)
names(ds) <- toupper(names(ds))
}
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
i
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
?excel_sheets
?read_excel
type(sheets)
typeof(sheets)
workFile
x <- capture.output(read_excel(workFile,sheetName))
capture.output(x <- read_excel(workFile,sheetName))
capture.output(x <- read_excel(workFile,sheetName), output=NULL)
capture.output(x <- read_excel(workFile,sheetName), output='NULL')
capture.output(x <- read_excel(workFile,sheetName), output='NUL')
capture.output(x <- read_excel(workFile,sheetName), file ='NUL')
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
capture.output(y <- read_excel(workFile,sheetName), file ='NUL')
View(y)
z <- capture.output(y <- read_excel(workFile,sheetName), file ='NUL')
z
setwd("Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Graduations")
setwd("Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Graduations")
ds_list <- list()
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
if ("varlist" %in% sheets) {
ds <- read_excel(workFile,"varlist")
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
}
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
rm(ds)
getwd()
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
if ("varlist" %in% sheets) {
capture.output(ds <- read_excel(workFile,"varlist"), file ='NUL')
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
}
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
rm(ds)
setwd("Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Graduations")
ds_list <- list()
i <- 1
length(list.files())
workFile <- list.files()[i]
sheets <-   tolower(excel_sheets(workFile))
capture.output(sheets <- tolower(excel_sheets(workFile), file='NUL')
capture.output(sheets <- tolower(excel_sheets(workFile), file='NUL'))
tolower(capture.output(sheets <- excel_sheets(workFile), file='NUL'))
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
ds_list <- list()
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
capture.output(ds <- read_excel(workFile,"varlist"), file ='NUL')
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
}
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
rm(ds)
names(ds1)
ds_list <- list()
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
names(ds)
names(ds3)
rm(ds)
library("reshape", lib.loc="~/R/win-library/3.2")
reshape::
?merge_recurse
all <- merge_recurse(ds_list)
View(all)
?merge_recurse
?merge
intersect?
?intersect
all2 <- merge_recurse(ds_list,all.x=T, all.y=T)
?merge_recurse
?merge
setwd("Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Fall Enrollment A")
ds_list <- list()
list.files()
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
rm(ds)
all <- merge_recurse(ds_list)
all2 <- merge_recurse(ds_list, all.x=T, all.y=T)
View(all)
table(all$VARNAME,all$VARTITLE)
table(all$VARNAME)
all <- merge(ds1, ds2, by = intersect(names(ds1), names(ds2)), all.x=T, all.y=T)
rm(all)
all <- merge(ds1, ds2, by = intersect(names(ds1), names(ds2)), all.x=T, all.y=T)
all <- merge(all, ds3, by = intersect(names(all), names(ds3)), all.x=T, all.y=T)
all <- merge(all, ds4, by = intersect(names(all), names(ds4)), all.x=T, all.y=T)
all <- merge(all, ds5, by = intersect(names(all), names(ds5)), all.x=T, all.y=T)
all <- merge(all, ds6, by = intersect(names(all), names(ds6)), all.x=T, all.y=T)
all <- merge(all, ds7, by = intersect(names(all), names(ds7)), all.x=T, all.y=T)
?merge
rm(all)
all <- merge(ds1, ds2, by = intersect(names(ds1), names(ds2)), all.x=T, all.y=T)
table(all$VARNAME)
all <- merge(ds1, ds2, by = "VARNAME", all.x=T, all.y=T)
View(all)
length(list.files()):1
rm(all)
?rm
setwd("Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Fall Enrollment A")
ds_list <- list()
for (i in length(list.files()):1) {
workFile <- list.files()[i]
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
View(ds1)
View(ds6)
ds_list <- list()
j <- 1
for (i in length(list.files()):1) {
workFile <- list.files()[i]
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
ds_list[[j]] <- assign(paste("ds",i,sep=""),ds)
j <- j+1
}
View(ds1)
ds_list <- list()
j <- 1
for (i in length(list.files()):1) {
workFile <- list.files()[i]
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
ds_list[[j]] <- assign(paste("ds",j,sep=""),ds)
j <- j+1
}
View(ds1)
View(ds6)
rm(ds)
all <- merge_recurse(ds_list)
all2 <- merge_recurse(ds_list, all.x=T, all.y=T)
all3 <- merge_recurse(ds_list, by = "VARNAME", all.x=T, all.y=T)
View(all3)
?merge
all3 <- merge_recurse(ds_list, by.x = "VARNAME", all.x=T, all.y=T)
all3 <- merge_recurse(ds_list, by.x = "VARNAME")
all3 <- merge_recurse(ds_list, by.y = "VARNAME")
names(ds_list[[3]])
all3 <- merge_recurse(ds_list, by = "VARNAME")
all3 <- merge_recurse(ds_list, all)
all3 <- merge_all(ds_list)
names(ds1)
names(ds2)
intersect(names(ds1),names(ds2))
all4 <- merge(recurse(ds_list, by="VARNAME"))
all4 <- merge_recurse(ds_list, by="VARNAME")
all4 <- merge_recurse(ds_list, by.x="VARNAME", by.y="VARNAME")
View(all4)
all4 <- merge_recurse(ds_list, by.x="VARNAME", by.y="VARNAME", all=FALSE)
names(ds_list)
setwd("Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Fall Enrollment A")
#create empty list and read in all teh csvs in your wd
ds_list <- list()
j <- 1
for (i in length(list.files()):1) {
workFile <- list.files()[i]
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
names(ds) <- toupper(names(ds))
ds_list[[j]] <- assign(paste("ds",j,sep=""),ds)
j <- j+1
}
rm(ds)
all <- merge(ds1, ds2, by = intersect(names(ds1), names(ds2)), all.x=T, all.y=T)
all <- merge(all, ds3, by = intersect(names(all), names(ds3)), all.x=T, all.y=T)
all <- merge(all, ds4, by = intersect(names(all), names(ds4)), all.x=T, all.y=T)
all <- merge(all, ds5, by = intersect(names(all), names(ds5)), all.x=T, all.y=T)
all <- merge(all, ds6, by = intersect(names(all), names(ds6)), all.x=T, all.y=T)
all <- merge(all, ds7, by = intersect(names(all), names(ds7)), all.x=T, all.y=T)
View(all)
x <- as.data.frame(table(all$VARNAME))
View(x)
nrow(x)
all2 <- merge_recurse(ds_list)
all3 <- merge_all(ds_list)
all4 <- merge_recurse(ds_list, all.x=T, all.y=T)
all4 <- merge_recurse(ds_list, by = "VARNAME")
View(all4)
all4 <- merge_recurse(ds_list, by = "VARNAME", all=FALSE)
all4 <- merge_all(ds_list, by = "VARNAME", all=FALSE)
names(ds)
names(ds1)
list.files()
?str
workFile <- list.files()[i]
year <- substr(workFile,3,6)
myall <- merge_recurse(ds_list,by="VARNAME", all=FALSE)
?merge
myall <- merge_recurse(ds_list,by="VARNAME")
myall <- merge_recurse(ds_list,by="VARNAME",all.x=FALSE, all.y=FALSE)
View(myall)
names(ds1)
ds1_abridged <- ds1[,names(ds1) %in% c("VARNAME","IMPUTATIONVAR")]
View(ds1_abridged)
df <- data.frame(ID=c(1, 2, 2, 3), time=1:4, OS="Linux")
View(df)
df_unique <- unique(ddply(df, .(ID), function(x) data.frame(ID=x[,"ID"], time=max(x$time), OS=tail(x$OS,1))))
View(df_unique)
ds1[[year]] <- 2009
View(ds1)
ds1[[year]] <- 2009
View(ds1)
ds1[['year']] <- 2009
names(ds1)
ds1[['year']] <- 2014
View(ds1)
ds_list <- list()
j <- 1
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
year <- substr(workFile,3,6)
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
ds[['year']] <- year
names(ds) <- toupper(names(ds))
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
rm(ds)
all2 <- merge_all(ds_list, by="VARNAME")
all2 <- merge_all(ds_list)
all2 <- merge_all(ds_list)
View(all2)
?ddply
?ddply
View(df)
all_unduplicated <- unique(ddply(all, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"], time=max(x[[YEAR]]))))
?DDPLY
?ddply
ddply(all, .(VARNAME))
all_dedup <- ddply(all, .(VARNAME))
?unique
all_unduplicated <- unique(ddply(all, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"], time=max(x[YEAR]))))
all_unduplicated <- unique(ddply(all, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"], time=max(x$YEAR))))
warnings()[1:5]
ddply(all, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"], time=max(x$YEAR)))
View(df)
View(all)
all <- merge_all(ds_list)
View(all)
all_unduplicated <- unique(ddply(all, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"], YEAR=max(x$YEAR))))
View(all_unduplicated)
names(all)
?tail
all_unduplicated <- unique(ddply(all, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"], YEAR=max(x$YEAR),DATATYPE=tail(x$DATATYPE,1),)))
table(all$FORMAT)
table(all$DATATYPE)
?merge
myall <- all
myall <- merge_all(ds_list)
rm(all)
all_unduplicated <- unique(ddply(all, .(VARNAME),
function(x) data.frame(VARNAME=x[,"VARNAME"],
YEAR=max(x$YEAR))))
all_unduplicated <- unique(ddply(all, .(VARNAME),
function(x) data.frame(VARNAME=x[,"VARNAME"],
YEAR=max(x$YEAR))))
rm(all_unduplicated)
?duplicated
all_unduplicated <- unique(ddply(all, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"],
YEAR=max(x$YEAR))))
all_unduplicated <- unique(ddply(myall, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"],
YEAR=max(x$YEAR))))
View(all_unduplicated)
?merge
final_all <- merge(all_unduplicated,myall,all=FALSE)                                                      YEAR=max(x$YEAR))))
final_all <- merge(all_unduplicated, myall, all=FALSE)
View(final_all)
finall_all_2 <- merge(myall, all_unduplicated, all=FALSE)
View(finall_all_2)
finall_all==finall_all_2
final_all==finall_all_2
getwd()
setwd("Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Fall Enrollment A")
ds_list <- list()
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
year <- substr(workFile,3,6)
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
ds[['year']] <- year
names(ds) <- toupper(names(ds))
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
ds_list <- list()
for (i in 1:length(list.files())) {
workFile <- list.files()[i]
year <- substr(workFile,3,6)
capture.output(sheets <- excel_sheets(workFile), file='NUL')
sheets <- tolower(sheets)
if ("varlist" %in% sheets) {
sheetName <- "varlist"
}
else {
print(sheets)
sheetName <- readline(prompt="Enter the name of the sheet: ")
}
capture.output(ds <- read_excel(workFile,sheetName), file ='NUL')
ds[['year']] <- year
names(ds) <- toupper(names(ds))
ds_list[[i]] <- assign(paste("ds",i,sep=""),ds)
}
rm(ds)
myall <- merge_all(ds_list)
all_unduplicated <- unique(ddply(myall, .(VARNAME), function(x) data.frame(VARNAME=x[,"VARNAME"],
YEAR=max(x$YEAR))))
final_all <- merge(all_unduplicated, myall, all=FALSE)
write.csv(final_dict, "Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Compiled Dictionary/efa_dictionary.csv")
write.csv(final_all, "Q:/Staff/OIRE/Staff Folders/Emma/Peer Database/IPEDS/Compiled Dictionary/efa_dictionary.csv")
library(readxl)
